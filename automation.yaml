#################################################################
## Automations
#################################################################

        ##########################################################
        ## _REDACTED_ Home from Waling Unlock Doors
        ##########################################################

- alias: _REDACTED_ Home from Waling Unlock Doors

  trigger:
    - platform: state
      entity_id: device_tracker._REDACTED_
      from: 'not_home'
      to: 'home'

  condition:
    - condition: state
      entity_id: input_boolean.home_away
      state: 'off'
    - condition: state
      entity_id: input_boolean._REDACTED__away
      state: 'on'
    - condition: state
      entity_id: input_boolean._REDACTED__away_driving
      state: 'off'
  
  action:
    service: lock.unlock
    entity_id: lock.back_door, lock.front_door

        ##########################################################
        ## _REDACTED_ Home from Driving Open Garage Door Unlock Door
        ##########################################################

- alias: _REDACTED_ Home from Driving Open Garage Door Unlock Door

  trigger:
    - platform: state
      entity_id: device_tracker._REDACTED_
      from: 'not_home'
      to: 'home'

  condition:
    - condition: state
      entity_id: input_boolean.disable_auto_garage
      state: 'off'
    - condition: state
      entity_id: input_boolean.home_away
      state: 'off'
    - condition: state
      entity_id: input_boolean._REDACTED__away
      state: 'on'
    - condition: state
      entity_id: input_boolean._REDACTED__away_driving
      state: 'on'
  
  action:
    - service: garage_door.open
      entity_id: garage_door.garage_door
    - service: lock.unlock
      entity_id: lock.back_door

        ##########################################################
        ## After _REDACTED_ Home Lock Doors
        ########################################################

- alias: _REDACTED_ Home Lock Doors

  trigger:
    - platform: state
      entity_id: input_boolean._REDACTED__away
      from: 'on'
      to: 'off'

  condition:
    - condition: state
      entity_id: input_boolean.disable_lock_unlock_doors
      state: 'off'
    - condition: state
      entity_id: binary_sensor.front_door
      state: 'off'
    - condition: state
      entity_id: binary_sensor.back_door
      state: 'off'

  action:
    service: lock.lock
    entity_id: lock.back_door, lock.front_door

        ##########################################################
        ## After _REDACTED_ Home Close Garage Door
        ########################################################

- alias: _REDACTED_ Home Close Garage

  trigger:
    - platform: state
      entity_id: input_boolean._REDACTED__away
      from: 'on'
      to: 'off'

  condition:
    - condition: state
      entity_id: input_boolean.disable_auto_garage
      state: 'off'

  action:
    service: garage_door.close
    entity_id: garage_door.garage_door

        ##########################################################
        ## _REDACTED_ Home from Waling Unlock Doors
        ##########################################################

- alias: _REDACTED_ Home from Waling Unlock Doors

  trigger:
    - platform: state
      entity_id: device_tracker._REDACTED_
      from: 'not_home'
      to: 'home'

  condition:
    - condition: state
      entity_id: input_boolean.home_away
      state: 'off'
    - condition: state
      entity_id: input_boolean._REDACTED__away
      state: 'on'
    - condition: state
      entity_id: input_boolean._REDACTED__away_driving
      state: 'off'


  action:
    service: lock.unlock
    entity_id: lock.back_door, lock.front_door

        ##########################################################
        ## _REDACTED_ Home from Driving Open Garage Door Unlock Door
        ##########################################################

- alias: _REDACTED_ Home from Driving Open Garage Door Unlock Door

  trigger:
    - platform: state
      entity_id: device_tracker._REDACTED_
      from: 'not_home'
      to: 'home'

  condition:
    - condition: state
      entity_id: input_boolean.disable_auto_garage
      state: 'off'
    - condition: state
      entity_id: input_boolean.home_away
      state: 'off'
    - condition: state
      entity_id: input_boolean._REDACTED__away
      state: 'on'
    - condition: state
      entity_id: input_boolean._REDACTED__away_driving
      state: 'on'

  action:
    - service: garage_door.open
      entity_id: garage_door.garage_door
    - service: lock.unlock
      entity_id: lock.back_door

        ##########################################################
        ## After _REDACTED_ Home Lock Doors
        ########################################################

- alias: _REDACTED_ Home Lock Doors

  trigger:
    - platform: state
      entity_id: input_boolean._REDACTED__away
      from: 'on'
      to: 'off'

  condition:
    - condition: state
      entity_id: input_boolean.disable_lock_unlock_doors
      state: 'off'
    - condition: state
      entity_id: binary_sensor.front_door
      state: 'off'
    - condition: state
      entity_id: binary_sensor.back_door
      state: 'off'

  action:
    service: lock.lock
    entity_id: lock.back_door, lock.front_door

        ##########################################################
        ## After _REDACTED_ Home Close Garage Door
        ########################################################

- alias: _REDACTED_ Home Close Garage

  trigger:
    - platform: state
      entity_id: input_boolean._REDACTED__away
      from: 'on'
      to: 'off'

  condition:
    - condition: state
      entity_id: input_boolean.disable_auto_garage
      state: 'off'

  action:
    service: garage_door.close
    entity_id: garage_door.garage_door

        ##########################################################
        ## _REDACTED_ Home Turn on Lights
        ##########################################################

- alias: _REDACTED_ Home

  trigger:
    - platform: state
      entity_id: device_tracker._REDACTED_
      from: 'not_home'
      to: 'home'

  condition:
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'
    - condition: state
      entity_id: input_boolean.home_away
      state: 'off'
    - condition: state
      entity_id: input_boolean._REDACTED__away
      state: 'on'

  action:
    - service: light.turn_on
      entity_id: group.home_lights
      data:
       xy_color: [ 0.5134, 0.4149 ]
       brightness: 150
    - service: light.turn_on
      entity_id: group.front_porch
      data:
       brightness: 65

        ##########################################################
        ## _REDACTED_ Home Turn on Lights
        ##########################################################

- alias: _REDACTED_ Home

  trigger:
    - platform: state
      entity_id: device_tracker._REDACTED_
      from: 'not_home'
      to: 'home'

  condition:
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'
    - condition: state
      entity_id: input_boolean.home_away
      state: 'off'
    - condition: state
      entity_id: input_boolean._REDACTED__away
      state: 'on'

  action:
    - service: light.turn_on
      entity_id: group.home_lights
      data:
       xy_color: [ 0.5134, 0.4149 ]
       brightness: 150
    - service: light.turn_on
      entity_id: group.front_porch
      data:
       brightness: 65

        ##########################################################
        ## Away Mode
        ##########################################################

- alias: Away Mode

  trigger:
    - platform: state
      entity_id: group.household
      from: 'home'
      to: 'not_home'

  condition:
    - condition: state
      entity_id: input_boolean.home_away
      state: 'off'

  action:
    - service: lock.lock
      entity_id: group.all_locks
    - service: light.turn_off
      entity_id: group.interior_lights
    - service: switch.turn_off
      entity_id: switch.air_purifier, switch.hallway_fan, switch.lower_backyard_outdoor_lighting, switch.lower_patio_outdoor_lighting, switch.fireplace
    - service: garage_door.close
      entity_id: garage_door.garage_door

        ##########################################################
        ## Close Garage Door when _REDACTED_ Leaves
        ##########################################################

- alias: Close Garage when _REDACTED_ Leaves

  trigger:
    - platform: state
      entity_id: input_boolean._REDACTED__away
      from: 'off'
      to: 'on'

  condition:
    - condition: state
      entity_id: input_boolean.disable_auto_garage
      state: 'off'

  action:
    service: garage_door.close
    entity_id: garage_door.garage_door

        ##########################################################
        ## Close Garage Door when _REDACTED_ Leaves
        ##########################################################

- alias: Close Garage when _REDACTED_ Leaves

  trigger:
    - platform: state
      entity_id: input_boolean._REDACTED__away
      from: 'off'
      to: 'on'

  condition:
    - condition: state
      entity_id: input_boolean.disable_auto_garage
      state: 'off'

  action:
    service: garage_door.close
    entity_id: garage_door.garage_door

        ##########################################################
        ## Plex Lights On/Off
        ##########################################################

- alias: "Media player paused/stopped"

  trigger:
    - platform: state
      entity_id: media_player.living_room
      from: 'playing'

  condition:
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'
    - condition: state
      entity_id: input_boolean.plex_lights_disable
      state: 'off'

  action:
    - service: light.turn_on
      entity_id: group.living_room_lamps
      data:
       transition: 3
       profile: relax
    - service: light.turn_on
      entity_id: light.hallway_light
      data:
       brightness: 25
    - service: light.turn_on
      entity_id: light.dining_room_table, light.bathroom_vanity, light.kitchen_cabinets, light.kitchen_sink
      data:
       brightness: 100

- alias: "Media player playing"

  trigger:
       - platform: state
         entity_id: media_player.living_room
         to: 'playing'

  condition:
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'
    - condition: state
      entity_id: input_boolean.plex_lights_disable
      state: 'off'

  action:
    - service: light.turn_off
      entity_id: group.living_room_lamps, light.hallway_light
      data:
       transition: 3
    - service: light.turn_off
      entity_id: group.dining_room, group.kitchen, light.bathroom_vanity

        ##########################################################
        ## Set Thermostat Away/Home
        ##########################################################

- alias: Thermostat - Home

  trigger:
    - platform: state
      entity_id: group.household
      from: 'not_home'
      to: 'home'
  
  condition:
    - condition: state
      entity_id: input_boolean.home_away
      state: 'off'

  action:
    entity_id: climate.main_floor
    service: climate.set_away_mode
    data:
      away_mode: 'False'

- alias: Thermostat - Away

  trigger:
    - platform: state
      entity_id: group.household
      from: 'home'
      to: 'not_home'

  condition:
    - condition: state
      entity_id: input_boolean.home_away
      state: 'off'

  action:
    entity_id: climate.main_floor
    service: climate.set_away_mode
    data:
      away_mode: 'True'

        ##########################################################
        ## Turn On Front Porch when Door Opens
        ##########################################################

- alias: Turn on Front Porch when Door Opens

  trigger:
    - platform: state
      entity_id: binary_sensor.front_door
      from: 'off'
      to: 'on'

  condition:
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'
    - condition: state
      entity_id: input_boolean.door_open_lights_on
      state: 'off'

  action:
    service: light.turn_on
    entity_id: group.front_porch
    data:
      brightness: 255

        ##########################################################
        ## Reset Front Door Brightness when Door Closes
        ##########################################################

- alias: Reset Front Porch Brightness when Door Closes

  trigger:
    - platform: state
      entity_id: binary_sensor.front_door
      from: 'on'
      to: 'off'
      for:
        hours: 0
        minutes: 3
        seconds: 0

  condition:
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'
    - condition: state
      entity_id: input_boolean.door_open_lights_on
      state: 'off'
    - condition: state
      entity_id: group.household
      state: 'home'
    - condition: state
      entity_id: input_select.holiday
      state: 'None'

  action:
    service: light.turn_on
    entity_id: group.front_porch
    data:
      brightness: 65

        ##########################################################
        ## Turn off Front Porch when Door Closes after 10p
        ##########################################################

- alias: Turn off Front Porch when Door Closes after 10p

  trigger:
    - platform: state
      entity_id: binary_sensor.front_door
      from: 'on'
      to: 'off'
      for:
        hours: 0
        minutes: 10
        seconds: 0

  condition:
    - condition: time
      after: '22:00'
    - condition: state
      entity_id: input_boolean.door_open_lights_on
      state: 'off'
    - condition: state
      entity_id: group.household
      state: 'home'
    - condition: state
      entity_id: input_select.holiday
      state: 'None'

  action:
    service: light.turn_off
    entity_id: group.front_porch

        ##########################################################
        ## Turn On Living Room when Door Opens
        ##########################################################

- alias: Turn on Front Porch when Door Opens

  trigger:
    - platform: state
      entity_id: binary_sensor.front_door
      from: 'off'
      to: 'on'

  condition:
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'
    - condition: state
      entity_id: input_boolean.door_open_lights_on
      state: 'off'

  action:
    service: light.turn_on
    entity_id: group.living_room
    data:
     xy_color: [ 0.5134, 0.4149 ]
     brightness: 255

        ##########################################################
        ## Turn On Back Door when Door Opens
        ##########################################################

- alias: Turn on Back Door when Door Opens

  trigger:
    - platform: state
      entity_id: binary_sensor.back_door
      from: 'off'
      to: 'on'

  condition:
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'
    - condition: state
      entity_id: input_boolean.door_open_lights_on
      state: 'off'

  action:
    service: light.turn_on
    entity_id: group.back_door
    data:
     brightness: 200

        ##########################################################
        ## Turn off Back Door when Door Closes
        ##########################################################

- alias: Turn off Back Door when Door Closes

  trigger:
    - platform: state
      entity_id: binary_sensor.back_door
      from: 'on'
      to: 'off'
      for:
        hours: 0
        minutes: 10
        seconds: 0

  condition:
    - condition: time
      after: '21:30'
    - condition: state
      entity_id: input_boolean.door_open_lights_on
      state: 'off'
    - condition: state
      entity_id: group.household
      state: 'home'

  action:
    service: light.turn_off
    entity_id: group.back_door

        ##########################################################
        ## Turn off Garage Light when Garage Closed
        ########################################################

- alias: Turn off Garage Light when Garage Closed

  trigger:
    - platform: state
      entity_id: garage_door.garage_door
      from: 'open'
      to: 'closed'
      for:
        hours: 0
        minutes: 5
        seconds: 0

  condition:
    - condition: state
      entity_id: input_boolean.door_open_lights_on
      state: 'off'

  action:
    service: light.turn_off
    entity_id: light.garage_light

        ##########################################################
        ## Turn on Garage Light when Garage Open
        ########################################################

- alias: Turn on Garage Light when Garage Open

  trigger:
    - platform: state
      entity_id: garage_door.garage_door
      from: 'closed'
      to: 'open'

  condition:
    - condition: state
      entity_id: input_boolean.door_open_lights_on
      state: 'off'
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'

  action:
    service: light.turn_on
    entity_id: light.garage_light

        ##########################################################
        ## Close Garage Door after 30 Mins
        ##########################################################
      
- alias: 'Close Garage Door After 30 Mins'

  trigger:  
    - platform: state
      entity_id: garage_door.garage_door
      from: 'closed'
      to: 'open'
      for:
        hours: 0
        minutes: 30
        seconds: 0
  
  condition:
    - condition: state
      entity_id: input_boolean.disable_auto_garage
      state: 'off'

  action:
    service: garage_door.close
    entity_id: garage_door.garage_door

        ##########################################################
        ## Lock Front Door After 30 Mins
        ##########################################################
      
- alias: 'Lock Front Door After 30 Mins'

  trigger:  
    - platform: state
      entity_id: lock.front_door
      from: 'locked'
      to: 'unlocked'
      for:
        hours: 0
        minutes: 30
        seconds: 0
  
  condition:
    - condition: state
      entity_id: input_boolean.disable_lock_unlock_doors
      state: 'off'
    - condition: state
      entity_id: binary_sensor.front_door
      state: 'off'
    - condition: state
      entity_id: lock.front_door
      state: 'unlocked'    
  
  action:
    service: lock.lock
    entity_id: lock.front_door

        ##########################################################
        ## Lock Back Door After 2 Hours
        ##########################################################
      
- alias: 'Lock Front Door After 2 Hours'

  trigger:  
    - platform: state
      entity_id: lock.back_door
      from: 'locked'
      to: 'unlocked'
      for:
        hours: 2
        minutes: 0
        seconds: 0
  
  condition:
    - condition: state
      entity_id: input_boolean.disable_lock_unlock_doors
      state: 'off'
    - condition: state
      entity_id: binary_sensor.back_door
      state: 'off'
      for:
        hours: 1
        minutes: 0
        seconds: 0
    - condition: state
      entity_id: lock.back_door
      state: 'unlocked'   

  action:
    service: lock.lock
    entity_id: lock.back_door

        ##########################################################
        ## Lock Basement Door After 45 Mins
        ##########################################################

- alias: 'Lock Basement Door After 45 Mins'

  trigger:
    - platform: state
      entity_id: lock.basement_door
      from: 'locked'
      to: 'unlocked'
      for:
        hours: 0
        minutes: 45
        seconds: 0

  condition:
    - condition: state
      entity_id: input_boolean.disable_lock_unlock_doors
      state: 'off'
    - condition: state
      entity_id: binary_sensor.basement_door
      state: 'off'
    - condition: state
      entity_id: lock.basement_door
      state: 'unlocked'

  action:
    service: lock.lock
    entity_id: lock.basement_door

        ##########################################################
        ## Lock Back Door when _REDACTED_ Leaves in the Morning
        ##########################################################

- alias: Lock Back Door when _REDACTED_ Leaves

  trigger:
     - platform: state
       entity_id: device_tracker._REDACTED_
       from: 'home'
       to: 'not_home'

  condition:
    - condition: time
      after: '05:00'
      before: '07:00'
    - condition: state
      entity_id: input_boolean.disable_lock_unlock_doors
      state: 'off'
    - condition: state
      entity_id: binary_sensor.back_door
      state: 'off'
    - condition: state
      entity_id: lock.back_door
      state: 'unlocked'

  action:
    service: lock.lock
    entity_id: lock.back_door

        ##########################################################
        ## Lock Doors at 2a
        ##########################################################
      
- alias: 'Lock Doors at 2a'

  trigger:
    - platform: time
      after: '02:00'
  
  condition:
    - condition: state
      entity_id: input_boolean.disable_lock_unlock_doors
      state: 'off'
    - condition: state
      entity_id: group.doors
      state: 'off'
  
  action:
    service: lock.lock
    entity_id: group.all_locks


        ##########################################################
        ## Turn On Front Porch at Sunset
        ##########################################################

- alias: Turn on Front Porch at Sunset

  trigger:
    - platform: sun
      event: 'sunset'
      offset: '-00:05:00'

  condition:
    - condition: state
      entity_id: input_boolean.exterior_on_sunset
      state: 'off'
    - condition: state
      entity_id: input_select.holiday
      state: 'None'

  action:
    service: light.turn_on
    entity_id: group.front_porch
    data:
    # 900 seconds = 15 minutes
      transition: 300
      brightness: 65
      xy_color: [ 0.5134, 0.4149 ]

        ##########################################################
        ## Turn Off Front Porch at 10:00 pm
        ##########################################################

- alias: Turn Off Front Porch at 10p

  trigger:
   - platform: time
     after: '22:00'

  condition:
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'
    - condition: state
      entity_id: input_boolean.exterior_off_night
      state: 'off'
    - condition: state
      entity_id: input_select.holiday
      state: 'None'

  action:
    service: light.turn_off
    entity_id: group.front_porch

        ##########################################################
        ## Turn on Back Door at Sunset when _REDACTED_ Leaves Work
        ##########################################################

- alias: Turn on Back Door at Sunset

  trigger:
    - platform: state
      entity_id: device_tracker._REDACTED_
      from: 'work'
      to: 'not_home'

  condition:
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'
    - condition: state
      entity_id: input_boolean.exterior_on_sunset
      state: 'off'

  action:
    service: light.turn_on
    entity_id: group.back_door
    data:
     brightness: 200

        ##########################################################
        ## Turn Off Back Door at 9:30 pm
        ##########################################################

- alias: Back Door Off at 9:30p

  trigger:
    - platform: time
      after: '21:30'
     
  condition:
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'
    - condition: state
      entity_id: input_boolean.exterior_off_night
      state: 'off'

  action:
   service: light.turn_off
   entity_id: group.back_door

        ##########################################################
        ## Turn on Back Door at 5:00a if _REDACTED_ Home
        ##########################################################

- alias: Back Door on at 5a

  trigger:
    - platform: time
      after: '05:00'

  condition:
    - condition: state
      entity_id: device_tracker._REDACTED_
      state: 'home'
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'
    - condition: state
      entity_id: input_boolean.lights_morning_disable
      state: 'off'

  action:
    service: light.turn_on
    entity_id: group.back_door
    data:
     brightness: 200

        ##########################################################
        ## Turn on Lights at 5a if _REDACTED_ Home
        ##########################################################

- alias: Turn on Interior Lights at 5a

  trigger:
    - platform: time
      after: '05:00'

  condition:
    - condition: state
      entity_id: device_tracker._REDACTED_
      state: 'home'
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'
    - condition: state
      entity_id: input_boolean.lights_morning_disable
      state: 'off'

  action:
    service: light.turn_on
    entity_id: light.dining_room_table, light.kitchen_cabinets, group.living_room, light.bahtroom_vanity
    data:
     brightness: 15
     xy_color: [ 0.5134, 0.4149 ]

        ##########################################################
        ## Open Garage Door when _REDACTED_ Leaves
        ##########################################################

- alias: _REDACTED_ Leaving Open Garage

  trigger:
    - platform: state
      entity_id: binary_sensor.back_door
      from: 'off'
      to: 'on'

  condition:
    - condition: time
      after: '05:00'
      before: '07:00'
    - condition: state
      entity_id: input_boolean.disable_auto_garage
      state: 'off'
    - condition: state
      entity_id: input_boolean._REDACTED__away
      state: 'off'

  action:
    service: garage_door.open
    entity_id: garage_door.garage_door

        ##########################################################
        ## Turn off Lights when _REDACTED_ Leaves
        ##########################################################

- alias: Turn off Lights when _REDACTED_ Leaves

  trigger:
    - platform: state
      entity_id: device_tracker._REDACTED_
      from: 'home'
      to: 'not_home'
  
  condition:
    - condition: time
      after: '05:00'
      before: '07:00'
    - condition: state
      entity_id: input_boolean.home_away
      state: 'off'

  action:
    service: light.turn_off
    entity_id: group.interior_lights, group.back_door

        ##########################################################
        ## Turn off Lights at Sunrise
        ##########################################################

- alias: Turn off Lights at Sunrise

  trigger:
    - platform: sun
      event: 'sunrise'
      offset: '+00:20:00'

  action:
    - service: light.turn_off
      entity_id: group.interior_lights, group.exterior_lights
    - service: switch.turn_off
      entity_id: switch.lower_backyard_outdoor_lighting
    - service: switch.turn_off
      entity_id: switch.lower_patio_outdoor_lighting

        ##########################################################
        ## Turn on Office Air Purifier when Occupied
        ##########################################################

- alias: Turn on Office Air Purifier when Occupied

  trigger:
    - platform: state
      entity_id: sensor.office_occupancy
      from: 'false'
      to: 'true'

  condition:
    - condition: state
      entity_id: input_boolean.occupancy_air_purifier_on_off_disable
      state: 'off'
    - condition: state
      entity_id: device_tracker._REDACTED_
      state: 'home'         

  action:
    service: switch.turn_on
    entity_id: switch.air_purifier

        ##########################################################
        ## Turn off Office Air Purifier when Unoccupied
        ##########################################################

- alias: Turn off Office Air Purifier when Unoccupied

  trigger:
    - platform: state
      entity_id: sensor.office_occupancy
      from: 'true'
      to: 'false'
      for:
        hours: 0
        minutes: 30
        seconds: 0

  condition:
    - condition: state
      entity_id: input_boolean.occupancy_air_purifier_on_off_disable
      state: 'off'     

  action:
    service: switch.turn_off
    entity_id: switch.air_purifier

        ##########################################################
        ## Turn off Office when Unoccupied
        ##########################################################

- alias: Turn off Office Light when Unoccupied

  trigger:
    - platform: state
      entity_id: sensor.office_occupancy
      from: 'true'
      to: 'false'
      for:
        hours: 0
        minutes: 30
        seconds: 0

  condition:
    - condition: state
      entity_id: input_boolean.occupancy_lights_off_disable
      state: 'off'         


  action:
    service: light.turn_off
    entity_id: group._REDACTED__office

        ##########################################################
        ## Turn off _REDACTED_ Office when Unoccupied
        ##########################################################

- alias: Turn off _REDACTED_ Office Light when Unoccupied

  trigger:
    - platform: state
      entity_id: sensor._REDACTED__office_occupancy
      from: 'true'
      to: 'false'
      for:
        hours: 0
        minutes: 30
        seconds: 0

  condition:
    - condition: state
      entity_id: input_boolean.occupancy_lights_off_disable
      state: 'off'         

  action:
    service: light.turn_off
    entity_id: group._REDACTED__office

        ##########################################################
        ## Turn off Bedroom when Unoccupied
        ##########################################################

- alias: Turn off Bedroom Light when Unoccupied

  trigger:
    - platform: state
      entity_id: sensor.bedroom_occupancy
      from: 'true'
      to: 'false'
      for:
        hours: 0
        minutes: 30
        seconds: 0

  condition:
    - condition: state
      entity_id: input_boolean.occupancy_lights_off_disable
      state: 'off'         

  action:
    service: light.turn_off
    entity_id: group.bedroom

        ##########################################################
        ## Turn off Guest Bedroom when Unoccupied
        ##########################################################

- alias: Turn off Guest Bedroom Light when Unoccupied

  trigger:
    - platform: state
      entity_id: sensor.guest_bedroom_occupancy
      from: 'true'
      to: 'false'
      for:
        hours: 0
        minutes: 60
        seconds: 0

  condition:
    - condition: state
      entity_id: input_boolean.occupancy_lights_off_disable
      state: 'off'         

  action:
    service: light.turn_off
    entity_id: group.guest_bedroom

        ##########################################################
        ## Turn off Kitchen when Unoccupied
        ##########################################################

- alias: Turn off Kitchen Light when Unoccupied

  trigger:
    - platform: state
      entity_id: sensor.kitchen_occupancy
      from: 'true'
      to: 'false'
      for:
        hours: 0
        minutes: 30
        seconds: 0
  
  condition:
    - condition: state
      entity_id: input_boolean.occupancy_lights_off_disable
      state: 'off'         

  action:
    service: light.turn_off
    entity_id: group.kitchen

        ##########################################################
        ## Turn off Dining Room / Hallway when Unoccupied
        ##########################################################

- alias: Turn off Dining Room when Unoccupied

  trigger:
    - platform: state
      entity_id: sensor.main_floor_occupancy
      from: 'true'
      to: 'false'
      for:
        hours: 0
        minutes: 60
        seconds: 0
         
  condition:
    - condition: state
      entity_id: input_boolean.occupancy_lights_off_disable
      state: 'off'         

  action:
    service: light.turn_off
    entity_id: light.hallway_light, group.dining_room

        ##########################################################
        ## Turn off Living Room when Unoccupied
        ##########################################################

- alias: Turn off Living Room when Unoccupied

  trigger:
    - platform: state
      entity_id: sensor.living_room_occupancy
      from: 'true'
      to: 'false'
      for:
        hours: 0
        minutes: 60
        seconds: 0

  condition:
    - condition: state
      entity_id: sensor.main_floor_occupancy
      state: 'false'
    - condition: state
      entity_id: input_boolean.occupancy_lights_off_disable
      state: 'off'                  

  action:
    service: light.turn_off
    entity_id: group.living_room

        ##########################################################
        ## Turn off Stairs when Unoccupied
        ##########################################################

- alias: Turn off Stairs when _REDACTED_ Unoccupied

  trigger:
    - platform: state
      entity_id: sensor.office_occupancy
      from: 'true'
      to: 'false'
      for:
        hours: 0
        minutes: 30
        seconds: 0

  condition:
    - condition: state
      entity_id: sensor._REDACTED__office_occupancy
      state: 'false'
    - condition: state
      entity_id: input_boolean.occupancy_lights_off_disable
      state: 'off'         

  action:
    service: light.turn_off
    entity_id: group.stairs

- alias: Turn off Stairs when _REDACTED_ Office Unoccupied

  trigger:
    - platform: state
      entity_id: sensor._REDACTED__office_occupancy
      from: 'true'
      to: 'false'
      for:
        hours: 0
        minutes: 10
        seconds: 0

  condition:
    - condition: state
      entity_id: sensor.office_occupancy
      state: 'false'
    - condition: state
      entity_id: input_boolean.occupancy_lights_off_disable
      state: 'off'         

  action:
    service: light.turn_off
    entity_id: group.stairs

        ##########################################################
        ## Turn on Living Room / Dining Room at Sunset when Occupied
        ##########################################################

- alias: Turn on Lights at Sunset when Occupied

  trigger:
    - platform: sun
      event: 'sunset'
      offset: '-00:59:00'

  condition:
    condition: or
    conditions:
      - condition: state
        entity_id: sensor.main_floor_occupancy
        state: 'true'
      - condition: state
        entity_id: sensor.living_room_occupancy
        state: 'true'
      - condition: state
        entity_id: group.household
        state: 'home'

  action:
    service: light.turn_on
    entity_id: group.living_room, light.dining_room_table
    data:
    # 900 seconds = 15 minutes
      transition: 3600
      xy_color: [ 0.5134, 0.4149 ]
      brightness: 255


        ##########################################################
        ## Turn on Office at Sunset when Occupied
        ##########################################################

- alias: Turn on Office Lights at Sunset when Occupied

  trigger:
    - platform: sun
      event: 'sunset'
      offset: '-00:10:00'

  condition:
    - condition: state
      entity_id: sensor.office_occupancy
      state: 'true'
    - condition: state
      entity_id: input_boolean.office_lights_sunset
      state: 'off'
    - condition: state
      entity_id: device_tracker._REDACTED_
      state: 'home'

  action:
    service: light.turn_on
    entity_id: light.office_lamp
    data:
    # 900 seconds = 15 minutes
      transition: 1200
      brightness: 75

        ##########################################################
        ## Turn on _REDACTED_'s Office at Sunset when Occupied
        ##########################################################

- alias: Turn on _REDACTED_ Office Lights at Sunset when Occupied

  trigger:
    - platform: sun
      event: 'sunset'
      offset: '-00:10:00'

  condition:
    - condition: state
      entity_id: sensor._REDACTED__office_occupancy
      state: 'true'
    - condition: state
      entity_id: input_boolean.office_lights_sunset
      state: 'off'
    - condition: state
      entity_id: device_tracker._REDACTED_
      state: 'home'

  action:
    service: light.turn_on
    entity_id: group._REDACTED__office
    data:
    # 900 seconds = 15 minutes
      transition: 1200
      brightness: 75

        ##########################################################
        ## Turn On/Off First Floor Lights During Rain
        ##########################################################

- alias: Rainy Day First Floor

  trigger:
    - platform: state
      entity_id: sensor.forecastio_precip
      state: 'rain'

  condition:
    - condition: state
      entity_id: group.household
      state: 'home'
    - condition: time
      after: '09:00'
    - condition: state
      entity_id: sun.sun
      state: 'above_horizon'
    - condition: state
      entity_id: sensor.main_floor_occupancy
      state: 'true'
    - condition: state
      entity_id: input_boolean.rainy_day_disable
      state: 'off'
    - condition: state
      entity_id: group.household
      state: 'home'

  action:
    service: light.turn_on
    entity_id: group.rain_lights
    data:
     xy_color: [ 0.5134, 0.4149 ]
     brightness: 50

#- alias: Rain is over First Floor
#  
#  trigger:
#    - platform: state
#      entity_id: sensor.forecastio_precip
#      state: 'unknown'
#  
#  condition:
#    - condition: state
#      entity_id: sun.sun
#      state: 'above_horizon'
#         
#  action:
#    service: light.turn_off
#    entity_id: group.rain_lights

        ##########################################################
        ## Turn On/Off _REDACTED_ Office During Rain
        ##########################################################

- alias: Rainy Day _REDACTED_ Office

  trigger:
    - platform: state
      entity_id: sensor.forecastio_precip
      state: 'rain'

  condition:
    - condition: state
      entity_id: sensor._REDACTED__office_occupancy
      state: 'true'
    - condition: state
      entity_id: sun.sun
      state: 'above_horizon'
    - condition: state
      entity_id: input_boolean.rainy_day_disable
      state: 'off'
    - condition: state
      entity_id: device_tracker._REDACTED_
      state: 'home'

  action:
    service: light.turn_on
    entity_id: group._REDACTED__office
    data:
     brightness: 50

#- alias: Rain is over _REDACTED_ Office
#  
#  trigger:
#    - platform: state
#      entity_id: sensor.forecastio_precip
#      state: 'unknown'
#
#  condition:
#    - condition: state
#      entity_id: sun.sun
#      state: 'above_horizon'
#
#  condition: use_trigger_values
#  action:
#    service: light.turn_off
#    entity_id: group._REDACTED__office, group.stairs

        ##########################################################
        ## Turn On/Off _REDACTED_ Office During Rain
        ##########################################################

- alias: Rainy Day _REDACTED_ Office

  trigger:
    - platform: state
      entity_id: sensor.forecastio_precip
      state: 'rain'

  condition:
    - condition: state
      entity_id: sensor.office_occupancy
      state: 'true'
    - condition: state
      entity_id: sun.sun
      state: 'above_horizon'
    - condition: state
      entity_id: input_boolean.rainy_day_disable
      state: 'off'
    - condition: state
      entity_id: device_tracker._REDACTED_
      state: 'home'

  action:
    service: light.turn_on
    entity_id: group._REDACTED__office, group.stairs
    data:
     brightness: 30
     xy_color: [0.139,0.081]

#- alias: Rain is over _REDACTED_ Office
#  
#  trigger:
#    - platform: state
#      entity_id: sensor.forecastio_precip
#      state: 'None'
#
#  condition:
#    - condition: state
#      entity_id: sun.sun
#      state: 'above_horizon'
#
#  action:
#    service: light.turn_off
#    entity_id: group._REDACTED__office, group.stairs

        ##########################################################
        ## Turn On Outdoor Lighting at Sunset
        ##########################################################

- alias: Turn on Outdoor Porch at Sunset

  trigger:
    - platform: sun
      event: 'sunset'

  condition:
    - condition: state
      entity_id: input_boolean.exterior_on_sunset
      state: 'off'
    - condition: state
      entity_id: input_boolean.vacation_mode
      state: 'off'
    - condition: state
      entity_id: group.household
      state: 'home'

  action:
    - service: switch.turn_on
      entity_id: switch.lower_patio_outdoor_lighting
    - service: switch.turn_on
      entity_id: switch.lower_backyard_outdoor_lighting
    
        ##########################################################
        ## Turn Off Outdoor Lighting After 4 Hours
        ##########################################################

- alias: Turn off Outdoor Lighting at Sunset

  trigger:
    - platform: state
      entity_id: group.outdoor_lighting
      from: 'off'
      to: 'on'
      for:
        hours: 4
        minutes: 0
        seconds: 0

  condition:
    - condition: state
      entity_id: input_boolean.exterior_off_night
      state: 'off'
    - condition: time
      after: '22:00'

  action:
    - service: switch.turn_off
      entity_id: switch.lower_backyard_outdoor_lighting
    - service: switch.turn_off
      entity_id: switch.lower_patio_outdoor_lighting

        ##########################################################
        ## Turn Off Outdoor Lighting At Midnight on Weekends
        ##########################################################

- alias: Turn off Outdoor Lighting at 1a on Weekends

  trigger:
    - platform: time
      after: '23:59'

  condition:
    - condition: state
      entity_id: input_boolean.exterior_off_night
      state: 'off'
    - condition: time
      weekday:
        - fri
        - sat

  action:
    - service: switch.turn_off
      entity_id: switch.lower_backyard_outdoor_lighting
    - service: switch.turn_off
      entity_id: switch.lower_patio_outdoor_lighting

        ##########################################################
        ## Turn Off Outdoor Lighting At 10:00p on Weekdays
        ##########################################################

- alias: Turn off Outdoor Lighting at 10p on Weekdays

  trigger:
    - platform: time
      after: '22:00'

  condition:
    - condition: state
      entity_id: input_boolean.exterior_off_night
      state: 'off'
    - condition: time
      weekday:
        - sun
        - mon
        - tue
        - wed
        - thu

  action:
    - service: switch.turn_off
      entity_id: switch.lower_backyard_outdoor_lighting
    - service: switch.turn_off
      entity_id: switch.lower_patio_outdoor_lighting

        ##########################################################
        ## Turn on Outdoor Lighting when Home Weekdays
        ##########################################################

- alias: Turn on Outdoor Lighting when Home Weekdays

  trigger:
    - platform: state
      entity_id: group.household
      from: 'not_home'
      to: 'home'

  condition:
    - condition: state
      entity_id: input_boolean.home_away
      state: 'off'
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'
    - condition: time
      before: '22:00'
    - condition: time
      weekday:
        - sun
        - mon
        - tue
        - wed
        - thu

  action:
    - service: switch.turn_on
      entity_id: switch.lower_patio_outdoor_lighting
    - service: switch.turn_on
      entity_id: switch.lower_backyard_outdoor_lighting

        ##########################################################
        ## Turn on Outdoor Lighting when Home Weekends
        ##########################################################

- alias: Turn on Outdoor Lighting when Home Weekends

  trigger:
    - platform: state
      entity_id: group.household
      from: 'not_home'
      to: 'home'

  condition:
    - condition: state
      entity_id: input_boolean.home_away
      state: 'off'
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'
    - condition: time
      before: '23:59'
    - condition: time
      weekday:
        - fri
        - sat
  action:
    - service: switch.turn_on
      entity_id: switch.lower_patio_outdoor_lighting
    - service: switch.turn_on
      entity_id: switch.lower_backyard_outdoor_lighting

##################################################################
## Holiday Lighting
##################################################################
  
        ##########################################################
        ## Christmas Lighting
        ##########################################################

- alias: Christmas Lighting

  trigger:
    - platform: sun
      event: 'sunset'
      offset: '-00:05:00'

  condition:
    - condition: state
      entity_id: input_boolean.exterior_on_sunset
      state: 'off'
    - condition: state
      entity_id: input_select.holiday
      state: 'Christmas'

  action:
    - service: light.turn_on
      entity_id: light.front_porch_left
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: red
    - service: light.turn_on
      entity_id: light.front_porch_right
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: green

        ##########################################################
        ## Halloween Lighting
        ##########################################################

- alias: Halloween Lighting

  trigger:
    - platform: sun
      event: 'sunset'
      offset: '-00:05:00'

  condition:
    - condition: state
      entity_id: input_boolean.exterior_on_sunset
      state: 'off'
    - condition: state
      entity_id: input_select.holiday
      state: 'Halloween'

  action:
    - service: light.turn_on
      entity_id: light.front_porch_left
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: orange
    - service: light.turn_on
      entity_id: light.front_porch_right
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: orange

        ##########################################################
        ## St. Patricks Day Lighting
        ##########################################################

- alias: St. Patricks Day Lighting

  trigger:
    - platform: sun
      event: 'sunset'
      offset: '-00:05:00'

  condition:
    - condition: state
      entity_id: input_boolean.exterior_on_sunset
      state: 'off'
    - condition: state
      entity_id: input_select.holiday
      state: "St. Patrick's Day"

  action:
    - service: light.turn_on
      entity_id: light.front_porch_left
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: green
    - service: light.turn_on
      entity_id: light.front_porch_right
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: green

        ##########################################################
        ## Valentine's Day Lighting
        ##########################################################

- alias: Valentine's Day Lighting

  trigger:
    - platform: sun
      event: 'sunset'
      offset: '-00:05:00'

  condition:
    - condition: state
      entity_id: input_boolean.exterior_on_sunset
      state: 'off'
    - condition: state
      entity_id: input_select.holiday
      state: "Valentine's Day"

  action:
    - service: light.turn_on
      entity_id: light.front_porch_left
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: pink
    - service: light.turn_on
      entity_id: light.front_porch_right
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: pink

        ##########################################################
        ## Cardinals Game Lighting
        ##########################################################

- alias: Cardinals Game Lighting

  trigger:
    - platform: sun
      event: 'sunset'
      offset: '-00:05:00'

  condition:
    - condition: state
      entity_id: input_boolean.exterior_on_sunset
      state: 'off'
    - condition: state
      entity_id: input_select.holiday
      state: 'Cardinals Game'

  action:
    - service: light.turn_on
      entity_id: light.front_porch_left
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: red
    - service: light.turn_on
      entity_id: light.front_porch_right
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: red

        ##########################################################
        ## Easter Lighting
        ##########################################################

- alias: Easter Lighting

  trigger:
    - platform: sun
      event: 'sunset'
      offset: '-00:05:00'

  condition:
    - condition: state
      entity_id: input_boolean.exterior_on_sunset
      state: 'off'
    - condition: state
      entity_id: input_select.holiday
      state: 'Easter'

  action:
    - service: light.turn_on
      entity_id: light.front_porch_left
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: yellow
    - service: light.turn_on
      entity_id: light.front_porch_right
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: blue

        ##########################################################
        ## Thanksgiving Lighting
        ##########################################################

- alias: Thanksgiving Lighting

  trigger:
    - platform: sun
      event: 'sunset'
      offset: '-00:05:00'

  condition:
    - condition: state
      entity_id: input_boolean.exterior_on_sunset
      state: 'off'
    - condition: state
      entity_id: input_select.holiday
      state: 'Thanksgiving'

  action:
    - service: light.turn_on
      entity_id: light.front_porch_left
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: yellow
    - service: light.turn_on
      entity_id: light.front_porch_right
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: orange

        ##########################################################
        ## Labor Day Lighting
        ##########################################################

- alias: Labor Day Lighting

  trigger:
    - platform: sun
      event: 'sunset'
      offset: '-00:05:00'

  condition:
    - condition: state
      entity_id: input_boolean.exterior_on_sunset
      state: 'off'
    - condition: state
      entity_id: input_select.holiday
      state: 'Labor Day'

  action:
    - service: light.turn_on
      entity_id: light.front_porch_left
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: red
    - service: light.turn_on
      entity_id: light.front_porch_right
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: blue

        ##########################################################
        ## Memorial Day Lighting
        ##########################################################

- alias: Memorial Day Lighting

  trigger:
    - platform: sun
      event: 'sunset'
      offset: '-00:05:00'

  condition:
    - condition: state
      entity_id: input_boolean.exterior_on_sunset
      state: 'off'
    - condition: state
      entity_id: input_select.holiday
      state: 'Memorial Day'

  action:
    - service: light.turn_on
      entity_id: light.front_porch_left
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: red
    - service: light.turn_on
      entity_id: light.front_porch_right
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: blue

        ##########################################################
        ## Independence Day Lighting
        ##########################################################

- alias: Independence Day

  trigger:
    - platform: sun
      event: 'sunset'
      offset: '-00:05:00'

  condition:
    - condition: state
      entity_id: input_boolean.exterior_on_sunset
      state: 'off'
    - condition: state
      entity_id: input_select.holiday
      state: 'Independence Day'

  action:
    - service: light.turn_on
      entity_id: light.front_porch_left
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: red
    - service: light.turn_on
      entity_id: light.front_porch_right
      data:
      # 900 seconds = 15 minutes
        transition: 300
        brightness: 255
        color_name: blue

        ##########################################################
        ## Turn Off Holiday Lighting at 1:00 am
        ##########################################################

- alias: Turn Off Holiday Lighting at at 1a

  trigger:
    - platform: time
      after: '01:00'

  condition:
    condition: or
    conditions:
      - condition: state
        entity_id: input_select.holiday
        state: 'Christmas'
      - condition: state
        entity_id: input_select.holiday
        state: 'Halloween'
      - condition: state
        entity_id: input_select.holiday
        state: "St. Patrick's Day"
      - condition: state
        entity_id: input_select.holiday
        state: 'Easter'
      - condition: state
        entity_id: input_select.holiday
        state: "Valentine's Day"
      - condition: state
        entity_id: input_select.holiday
        state: 'Thanksgiving'
      - condition: state
        entity_id: input_select.holiday
        state: 'Labor Day'
      - condition: state
        entity_id: input_select.holiday
        state: 'Memorial Day'
      - condition: state
        entity_id: input_select.holiday
        state: 'Independence Day'
      - condition: state
        entity_id: input_select.holiday
        state: 'Cardinals Game'

  action:
    service: light.turn_off
    entity_id: group.front_porch

        ##########################################################
        ## Reset Holiday Lighting at 4a
        ##########################################################

- alias: Reset Holiday Lighting at 4a
 
  trigger:
    - platform: time
      after: '04:00'

  condition:
    condition: or
    conditions:
      - condition: state
        entity_id: input_select.holiday
        state: 'Halloween'
      - condition: state
        entity_id: input_select.holiday
        state: "St. Patrick's Day"
      - condition: state
        entity_id: input_select.holiday
        state: 'Easter'
      - condition: state
        entity_id: input_select.holiday
        state: "Valentine's Day"
      - condition: state
        entity_id: input_select.holiday
        state: 'Thanksgiving'
      - condition: state
        entity_id: input_select.holiday
        state: 'Labor Day'
      - condition: state
        entity_id: input_select.holiday
        state: 'Memorial Day'
      - condition: state
        entity_id: input_select.holiday
        state: 'Independence Day'
      - condition: state
        entity_id: input_select.holiday
        state: 'Cardinals Game'
    
  action:
    service: input_select.select_option
    data:
      entity_id: input_select.holiday
      option: "None"

##################################################################
## Security
##################################################################

- alias: Motion Based Security

  trigger:
    - platform: state
      entity_id: group.occupancy
      from: 'off'
      to: 'on'

  condition:
    - condition: state
      entity_id: group.household
      state: 'not_home'
    - condition: state
      entity_id: input_boolean.disable_security
      state: 'off'

  action:
    service: scene.turn_on
    entity_id: scene.security
     
- alias: Security Door Open

  trigger:
    - platform: state
      entity_id: group.doors
      from: 'off'
      to: 'on'

  condition:
    - condition: state
      entity_id: group.household
      state: 'not_home'
    - condition: state
      entity_id: input_boolean.disable_security
      state: 'off'

  action:
    service: scene.turn_on
    entity_id: scene.security

##################################################################
## On Demand Automation
##################################################################

        ##########################################################
        ## Hue Random Colors
        ##########################################################

- alias: 'Set Living Room to Random Color'

  trigger:
    - platform: time
      minutes: '/2'
      seconds: 0

  condition:
    - condition: state
      entity_id: input_boolean.livingroom_rainbow
      state: 'on'

  action:
    service: light.turn_on
    entity_id: group.living_room, light.hallway_light
    data:
      effect: random
      transition: 5
      brightness: 255

- alias: 'Set Office to Random Color'

  trigger:
    - platform: time
      minutes: '/2'
      seconds: 0

  condition:
    - condition: state
      entity_id: input_boolean.office_rainbow
      state: 'on'

  action:
    service: light.turn_on
    entity_id: light.office_lamp
    data:
      effect: random
      transition: 5
      brightness: 255

- alias: 'Set Front Porch to Random Color'

  trigger:
    - platform: time
      minutes: '/2'
      seconds: 0

  condition:
    - condition: state
      entity_id: input_boolean.front_porch_rainbow
      state: 'on'

  action:
    service: light.turn_on
    entity_id: group.front_porch
    data:
      effect: random
      transition: 5
      brightness: 255

        ##########################################################
        ## Lock / Unlock Doors on Demand
        ##########################################################

- alias: Lock Doors on Demand

  trigger:
    - platform: state
      entity_id: input_boolean.lock_doors
      state: 'on'

  action:
    service: lock.lock
    entity_id: group.all_locks

- alias: Reset Lock Doors Switch

  trigger:
    - platform: state
      entity_id: input_boolean.lock_doors
      from: 'off'
      to: 'on'
      for:
        hours: 0
        minutes: 5
        seconds: 0

  action:
    service: homeassistant.turn_off
    entity_id: input_boolean.lock_doors

- alias: Unlock Doors on Demand

  trigger:
    - platform: state
      entity_id: input_boolean.unlock_doors
      state: 'on'

  action:
    service: lock.unlock
    entity_id: group.all_locks

- alias: Reset Unlock Doors Switch

  trigger:
     - platform: state
       entity_id: input_boolean.unlock_doors
       from: 'off'
       to: 'on'
       for:
         hours: 0
         minutes: 5
         seconds: 0

  action:
    service: homeassistant.turn_off
    entity_id: input_boolean.unlock_doors

        ##########################################################
        ## Thermostat on Demand
        ##########################################################

- alias: Thermostat On Demand Home

  trigger:
    - platform: state
      entity_id: input_boolean.thermostat_away
      from: 'on'
      to: 'off'

  action:
    entity_id: climate.main_floor
    service: climate.set_away_mode
    data:
      away_mode: 'False'

- alias: Thermostat On Demand Away

  trigger:
    - platform: state
      entity_id: input_boolean.thermostat_away
      from: 'off'
      to: 'on'

  action:
    entity_id: climate.main_floor
    service: climate.set_away_mode
    data:
      away_mode: 'True'

        ##########################################################
        ## Panic Mode
        ##########################################################

- alias: Panic Mode

  trigger:
    - platform: state
      entity_id: input_boolean.panic_mode
      state: 'on'

  action:
    service: scene.turn_on
    entity_id: scene.security

        ##########################################################
        ## Garage Door on Demand (Echo Integration)
        ##########################################################

- alias: Open Garage Door on Demand

  trigger:
    - platform: state
      entity_id: input_boolean.garage_door
      state: 'on'

  condition:
    - condition: state
      entity_id: garage_door.garage_door
      state: 'closed'

  action:
    service: garage_door.open
    entity_id: garage_door.garage_door

- alias: Close Garage Door on Demand

  trigger:
    - platform: state
      entity_id: input_boolean.garage_door
      state: 'off'

  condition:
    - condition: state
      entity_id: garage_door.garage_door
      state: 'open'

  action:
    service: garage_door.close
    entity_id: garage_door.garage_door

        ##########################################################
        ## Bedtime
        ##########################################################

- alias: Bedtime

  trigger:
    - platform: state
      entity_id: input_boolean.bedtime
      state: 'on'

  action:
    - service: lock.lock
      entity_id: group.all_locks
    - service: light.turn_off
      entity_id: group.interior_lights, group.exterior_lights
    - service: switch.turn_off
      entity_id: switch.air_purifier, switch.hallway_fan, switch.lower_backyard_outdoor_lighting, switch.lower_patio_outdoor_lighting, switch.fireplace
    - service: garage_door.close
      entity_id: garage_door.garage_door
      
- alias: Reset Bedtime Switch

  trigger:
     - platform: state
       entity_id: input_boolean.bedtime
       from: 'off'
       to: 'on'
       for:
         hours: 0
         minutes: 5
         seconds: 0

  action:
    service: homeassistant.turn_off
    entity_id: input_boolean.bedtime

        ##########################################################
        ## Turn on Vacation Mode when Gone 24 Hours
        ##########################################################

- alias: Turn on Vacation Mode when Gone 24 Hours

  trigger:
    - platform: state
      entity_id: group.household
      from: 'home'
      to: 'not_home'
      for:
        hours: 24
        minutes: 0
        seconds: 0

  condition:
    - condition: state
      entity_id: input_boolean.home_away
      state: 'off'

  action:
    service: homeassistant.turn_on
    entity_id: input_boolean.vacation_mode

        ##########################################################
        ## Turn off Vacation Mode when Home
        ##########################################################

- alias: Turn off Vacation Mode when Home

  trigger:
    - platform: state
      entity_id: group.household
      from: 'not_home'
      to: 'home'

  condition:
    - condition: state
      entity_id: input_boolean.home_away
      state: 'off'

  action:
    service: homeassistant.turn_off
    entity_id: input_boolean.vacation_mode

        ##########################################################
        ## Turn on Vacation Mode when on Vacation
        ##########################################################

- alias: Turn on Vacation Mode when on Vacation

  trigger:
    - platform: state
      entity_id: device_tracker._REDACTED_
      from: 'not_home'
      to: 'vacation'

  condition:
    - condition: state
      entity_id: input_boolean.home_away
      state: 'off'

  action:
    service: homeassistant.turn_on
    entity_id: input_boolean.vacation_mode

        ##########################################################
        ## Turn on Vacation Mode when at the Lake
        ##########################################################

- alias: Turn on Vacation Mode when at the Lake

  trigger:
    - platform: state
      entity_id: device_tracker._REDACTED_
      from: 'not_home'
      to: 'lake'

  condition:
    - condition: state
      entity_id: input_boolean.home_away
      state: 'off'

  action:
    service: homeassistant.turn_on
    entity_id: input_boolean.vacation_mode

        ##########################################################
        ## Turn off Vacation Mode when leaving the Lake
        ##########################################################

- alias: Turn on Vacation Mode when at the Lake

  trigger:
    - platform: state
      entity_id: device_tracker._REDACTED_
      from: 'lake'
      to: 'not_home'

  condition:
    - condition: state
      entity_id: input_boolean.home_away
      state: 'off'

  action:
    service: homeassistant.turn_off
    entity_id: input_boolean.vacation_mode

        ##########################################################
        ## Vacation Mode
        ##########################################################

- alias: Vacation Mode

  trigger:
    - platform: state
      entity_id: sun.sun
      from: 'above_horizon'
      to: 'below_horizon'

  condition:
    - condition: state
      entity_id: input_boolean.vacation_mode
      state: 'on'

  action:
    service: scene.turn_on
    entity_id: scene.vacation

- alias: Vacation Mode Lights Off 1a

  trigger:
    - platform: time
      after: '01:12'

  condition:
    - condition: state
      entity_id: input_boolean.vacation_mode
      state: 'on'

  action:
   service: light.turn_off
   entity_id: light.basement_stairs, group.living_room

- alias: Vacation Mode Lights Off 10p

  trigger:
    - platform: time
      after: '10:32'

  condition:
    - condition: state
      entity_id: input_boolean.vacation_mode
      state: 'on'

  action:
   service: light.turn_off
   entity_id: light.office_ceiling, light.closet_lamp
   
- alias: Vacation Mode Disable Automation

  trigger:
    - platform: state
      entity_id: input_boolean.vacation_mode
      from: 'off'
      to: 'on'
      
  action:
    service: scene.turn_on
    entity_id: scene.vacation_disable_automation

- alias: Vacation Mode Enable Automation

  trigger:
    - platform: state
      entity_id: input_boolean.vacation_mode
      from: 'on'
      to: 'off'

  action:
    service: scene.turn_on
    entity_id: scene.vacation_enable_automation

        ##########################################################
        ## Notifications
        ##########################################################

- alias: Security Notify

  trigger:
    - platform: state
      entity_id: input_boolean.alarm_tripped
      from: 'off'
      to: 'on'

  action:
    service: persistent_notification.create
    data:
      message: "Alarm Has Been Tripped!"
      title: "Alarm"
      notification_id: "1"

#################################################################
## Work Arounds
#################################################################

        ##########################################################
        ## Disable Alarm when Home
        ##########################################################

- alias: Disable Alarm when Home

  trigger:
    - platform: state
      entity_id: group.household
      from: 'not_home'
      to: 'home'

  action:
    service: homeassistant.turn_on
    entity_id: input_boolean.disable_security

        ##########################################################
        ## Enable Alarm when Away
        ##########################################################

- alias: Enable Alarm when Away

  trigger:
    - platform: state
      entity_id: group.household
      from: 'home'
      to: 'not_home'
      for:
        hours: 0
        minutes: 10
        seconds: 0

  action:
    service: homeassistant.turn_off
    entity_id: input_boolean.disable_security

        ##########################################################
        ## Set _REDACTED_ Away Driving
        ##########################################################

- alias: Set _REDACTED_ Away Driving

  trigger:
    - platform: state
      entity_id: device_tracker._REDACTED_
      from: 'home'
      to: 'not_home'

  condition:
    - condition: state
      entity_id: garage_door.garage_door
      state: 'open'

  action:
    service: homeassistant.turn_on
    entity_id: input_boolean._REDACTED__away_driving

        ##########################################################
        ## Set _REDACTED_ Away after 1 Min
        ##########################################################

- alias: Set _REDACTED_ Away after 1 Mins

  trigger:
    - platform: state
      entity_id: device_tracker._REDACTED_
      from: 'home'
      to: 'not_home'
      for:
        hours: 0
        minutes: 1
        seconds: 0

  action:
    service: homeassistant.turn_on
    entity_id: input_boolean._REDACTED__away
    
        ##########################################################
        ## Set _REDACTED_ Home after 10 Mins
        ##########################################################

- alias: Set _REDACTED_ Home after 10 Mins

  trigger:
    - platform: state
      entity_id: device_tracker._REDACTED_
      from: 'not_home'
      to: 'home'
      for:
        hours: 0
        minutes: 10
        seconds: 0

  action:
    service: homeassistant.turn_off
    entity_id: input_boolean._REDACTED__away, input_boolean._REDACTED__away_driving

        ##########################################################
        ## Set _REDACTED_ Away Driving
        ##########################################################

- alias: Set _REDACTED_ Away Driving

  trigger:
    - platform: state
      entity_id: device_tracker._REDACTED_
      from: 'home'
      to: 'not_home'

  condition:
    - condition: state
      entity_id: garage_door.garage_door
      state: 'open'

  action:
    service: homeassistant.turn_on
    entity_id: input_boolean._REDACTED__away_driving
    
        ##########################################################
        ## Set _REDACTED_ Away after 1 Min
        ##########################################################

- alias: Set _REDACTED_ Away after 1 Mins

  trigger:
    - platform: state
      entity_id: device_tracker._REDACTED_
      from: 'home'
      to: 'not_home'
      for:
        hours: 0
        minutes: 1
        seconds: 0

  action:
    service: homeassistant.turn_on
    entity_id: input_boolean._REDACTED__away
    
        ##########################################################
        ## Set _REDACTED_ Home after 10 Mins
        ##########################################################

- alias: Set _REDACTED_ Home after 10 Mins

  trigger:
    - platform: state
      entity_id: device_tracker._REDACTED_
      from: 'not_home'
      to: 'home'
      for:
        hours: 0
        minutes: 10
        seconds: 0

  action:
    service: homeassistant.turn_off
    entity_id: input_boolean._REDACTED__away, input_boolean._REDACTED__away_driving

        ##########################################################
        ## Reset Garage Door Boolean Switch
        ##########################################################

- alias: Turn off Garage Door when Closed

  trigger:
    - platform: state
      entity_id: garage_door.garage_door
      from: 'open'
      to: 'closed'

  action:
    service: homeassistant.turn_off
    entity_id: input_boolean.garage_door
    
- alias: Turn on Garage Door when Open

  trigger:
    - platform: state
      entity_id: garage_door.garage_door
      from: 'closed'
      to: 'open'

  action:
    service: homeassistant.turn_on
    entity_id: input_boolean.garage_door

        ##########################################################
        ## Turn off Back Patio Twice
        ##########################################################

- alias: Turn off Back Patio Twice

  trigger:
    - platform: state
      entity_id: group.back_door
      from: 'on'
      to: 'off'
      for:
        hours: 0
        minutes: 0
        seconds: 60

  action:
    service: homeassistant.turn_off
    entity_id: light.upper_patio_left, light.upper_patio_right

        ##########################################################
        ## Turn off Back Door Twice
        ##########################################################

- alias: Turn off Back Door Twice

  trigger:
    - platform: state
      entity_id: group.back_porch
      from: 'on'
      to: 'off'
      for:
        hours: 0
        minutes: 0
        seconds: 60

  action:
    service: homeassistant.turn_off
    entity_id: light.back_door_left, light.back_door_right
    
        ##########################################################
        ## Turn on Lower BackYard after Patio
        ##########################################################

- alias: Turn on Lower BackYard after Patio

  trigger:
    - platform: state
      entity_id: switch.lower_patio_outdoor_lighting
      from: 'off'
      to: 'on'
      for:
        hours: 0
        minutes: 0
        seconds: 90

  action:
    service: switch.turn_on
    entity_id: switch.lower_backyard_outdoor_lighting

        ##########################################################
        ## POC
        ##########################################################
